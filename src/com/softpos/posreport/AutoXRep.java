package com.softpos.posreport;

import com.softpos.crm.pos.core.modal.CreditRec;
import com.softpos.crm.pos.core.modal.FinalcialRec;
import com.softpos.crm.pos.core.modal.HourlyRec;
import com.softpos.pos.core.controller.POSHWSetup;
import com.softpos.pos.core.controller.PPrint;
import com.softpos.pos.core.controller.PUtility;
import com.softpos.crm.pos.core.modal.PluRec;
import com.softpos.crm.pos.core.modal.PublicVar;
import com.softpos.pos.core.controller.Value;
import database.MySQLConnect;
import java.awt.event.KeyEvent;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import util.AppLogUtil;
import util.MSG;

public class AutoXRep extends javax.swing.JDialog {

    SimpleDateFormat DatefmtThai = new SimpleDateFormat("dd/MM/yyyy(HH:mm)", Locale.ENGLISH);
    SimpleDateFormat Datefmt = new SimpleDateFormat("yyyy-MM-dd", Locale.ENGLISH);
    SimpleDateFormat ShowDatefmt = new SimpleDateFormat("dd/MM/yyyy", Locale.ENGLISH);
    DecimalFormat DecFmt = new DecimalFormat("##,###,##0.00");
    DecimalFormat IntFmt = new DecimalFormat("##,###,##0");
    Date date = new Date();
    PPrint prn = new PPrint();
    private POSHWSetup POSHW;

    /**
     * Creates new form AutoXRep
     */
    public AutoXRep(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        TMacNo.setText("Mac " + Value.MACNO);
        POSHW = POSHWSetup.Bean(Value.getMacno());
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel4 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        chkTerminal = new javax.swing.JCheckBox();
        chkCashier = new javax.swing.JCheckBox();
        chkGroup = new javax.swing.JCheckBox();
        chkPlu = new javax.swing.JCheckBox();
        chkHourly = new javax.swing.JCheckBox();
        chkReceipt = new javax.swing.JCheckBox();
        chkVoid = new javax.swing.JCheckBox();
        chkCredit = new javax.swing.JCheckBox();
        chkGiftVoucher = new javax.swing.JCheckBox();
        bntSelectAll = new javax.swing.JButton();
        bntExit = new javax.swing.JButton();
        bntOK = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        TMacNo = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("รายงานยอดขายประจำเครื่อง Automatic X-Report");
        setFocusable(false);
        setUndecorated(true);

        jPanel4.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        jPanel2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        chkTerminal.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkTerminal.setText("รายงานยอดการเงินของเครื่อง (Terminal Report)");
        chkTerminal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkTerminalActionPerformed(evt);
            }
        });
        chkTerminal.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkTerminalKeyPressed(evt);
            }
        });

        chkCashier.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkCashier.setText("รายงานยอดขายตามพนักงานขาย (Cashier Report)");
        chkCashier.setEnabled(false);
        chkCashier.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkCashierActionPerformed(evt);
            }
        });
        chkCashier.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkCashierKeyPressed(evt);
            }
        });

        chkGroup.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkGroup.setText("รายงานการขายตามกลุ่มสินค้า (Department/Group Report)");
        chkGroup.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkGroupKeyPressed(evt);
            }
        });

        chkPlu.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkPlu.setText("รายงานการขายตามรหัสสินค้า (PLU-Code Report)");
        chkPlu.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkPluKeyPressed(evt);
            }
        });

        chkHourly.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkHourly.setText("รายงานการขายตามช่วงเวลา (Hourly Report)");
        chkHourly.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkHourlyKeyPressed(evt);
            }
        });

        chkReceipt.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkReceipt.setText("รายงานการขายตามบิล/ใบกำกับภาษีอย่างย่อ (Receipt Report)");
        chkReceipt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkReceiptKeyPressed(evt);
            }
        });

        chkVoid.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkVoid.setText("รายงานการทำรายการ Void (Void Report)");
        chkVoid.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkVoidKeyPressed(evt);
            }
        });

        chkCredit.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkCredit.setText("รายงานการรับชำระด้วยบัตรเครดิต (Credit Report)");
        chkCredit.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkCreditKeyPressed(evt);
            }
        });

        chkGiftVoucher.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        chkGiftVoucher.setText("รายงานการรับชำระด้วยบัตรของขวัญ (Gift Voucher Report)");
        chkGiftVoucher.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chkGiftVoucherKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(31, 31, 31)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(chkGiftVoucher)
                    .addComponent(chkCredit)
                    .addComponent(chkVoid)
                    .addComponent(chkReceipt)
                    .addComponent(chkHourly)
                    .addComponent(chkPlu)
                    .addComponent(chkGroup)
                    .addComponent(chkCashier)
                    .addComponent(chkTerminal))
                .addContainerGap(117, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(chkTerminal)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkCashier)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkGroup)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkPlu)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkHourly)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkReceipt)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkVoid)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkCredit)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkGiftVoucher)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        bntSelectAll.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        bntSelectAll.setText("F2 เลือกทุกรายงาน");
        bntSelectAll.setFocusable(false);
        bntSelectAll.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bntSelectAllActionPerformed(evt);
            }
        });

        bntExit.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        bntExit.setText("ESC ออก");
        bntExit.setFocusable(false);
        bntExit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bntExitActionPerformed(evt);
            }
        });

        bntOK.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        bntOK.setText("F5 พิมพ์");
        bntOK.setFocusable(false);
        bntOK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bntOKActionPerformed(evt);
            }
        });

        jPanel3.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(27, 23, 153));
        jLabel3.setText("กด Enter เพื่อเลื่อนรายการ     กด Space bar เพื่อเลือก /ยกเลิก รายการที่ต้องการ ");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(java.awt.Color.lightGray, 2));

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel1.setForeground(java.awt.Color.blue);
        jLabel1.setText("รายงานยอดขายประจำเครื่อง X-Report");

        TMacNo.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        TMacNo.setForeground(java.awt.Color.blue);
        TMacNo.setText("MAC 001");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addGap(30, 30, 30)
                .addComponent(TMacNo)
                .addContainerGap(97, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(TMacNo))
                .addContainerGap(20, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(bntSelectAll, javax.swing.GroupLayout.PREFERRED_SIZE, 164, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(bntOK, javax.swing.GroupLayout.DEFAULT_SIZE, 202, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(bntExit, javax.swing.GroupLayout.PREFERRED_SIZE, 159, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(bntSelectAll, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bntOK, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bntExit, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

private void chkTerminalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkTerminalActionPerformed
// TODO add your handling code here:
}//GEN-LAST:event_chkTerminalActionPerformed

private void chkTerminalKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkTerminalKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkCashier.requestFocus();
    }

}//GEN-LAST:event_chkTerminalKeyPressed

private void chkCashierActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkCashierActionPerformed
// TODO add your handling code here:
}//GEN-LAST:event_chkCashierActionPerformed

private void chkCashierKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkCashierKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkGroup.requestFocus();
    }
}//GEN-LAST:event_chkCashierKeyPressed

private void chkGroupKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkGroupKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkPlu.requestFocus();
    }
}//GEN-LAST:event_chkGroupKeyPressed

private void chkPluKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkPluKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkHourly.requestFocus();
    }
}//GEN-LAST:event_chkPluKeyPressed

private void chkHourlyKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkHourlyKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkReceipt.requestFocus();
    }
}//GEN-LAST:event_chkHourlyKeyPressed

private void chkReceiptKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkReceiptKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkVoid.requestFocus();
    }
}//GEN-LAST:event_chkReceiptKeyPressed

private void chkVoidKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkVoidKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkCredit.requestFocus();
    }
}//GEN-LAST:event_chkVoidKeyPressed

private void chkCreditKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkCreditKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkGiftVoucher.requestFocus();
    }
}//GEN-LAST:event_chkCreditKeyPressed

private void chkGiftVoucherKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chkGiftVoucherKeyPressed
    if (evt.getKeyCode() == KeyEvent.VK_F2) {
        bntSelectAllClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_F5) {
        bntOKClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
        bntExitClick();
    }
    if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
        chkTerminal.requestFocus();
    }
}//GEN-LAST:event_chkGiftVoucherKeyPressed

private void bntOKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bntOKActionPerformed
    bntOKClick();
}//GEN-LAST:event_bntOKActionPerformed

    private void bntExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bntExitActionPerformed
        dispose();
    }//GEN-LAST:event_bntExitActionPerformed

    private void bntSelectAllActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bntSelectAllActionPerformed
        bntSelectAllClick();
    }//GEN-LAST:event_bntSelectAllActionPerformed
    public void bntSelectAllClick() {
        chkTerminal.setSelected(true);
        chkCashier.setSelected(true);
        chkGroup.setSelected(true);
        chkPlu.setSelected(true);
        chkHourly.setSelected(true);
        chkReceipt.setSelected(true);
        chkVoid.setSelected(true);
        chkCredit.setSelected(true);
        chkGiftVoucher.setSelected(true);

    }

    public void bntExitClick() {
        this.dispose();
    }

    public void bntOKClick() {
        if (ChkSaleData()) {
            if (ChkSaleNoCash()) {
                if (Value.printdriver) {
//                    JOptionPane.showMessageDialog(null, Value.driverNotSupport);
                    if (chkTerminal.isSelected()) {
                        ProcessTerminal();
                    }
//                    if (chkCashier.isSelected()) {
//                        ProcessCashier();
//                    }
                    if (chkGroup.isSelected()) {
                        ProcessGroup();
                    }
                    if (chkPlu.isSelected()) {
                        ProcessPlu();
                    }
                    if (chkHourly.isSelected()) {
                        ProcessHourly();
                    }
                    if (chkReceipt.isSelected()) {
                        ProcessInv();
                    }
                    if (chkVoid.isSelected()) {
                        ProcessVoid();
                    }
                    if (chkCredit.isSelected()) {
                        ProcessCredit();
                    }
                    if (chkGiftVoucher.isSelected()) {
                        ProcessGiftVoucher();
                    }

                } else if (!Value.getComPort().equals("NONE")) {
                    if (prn.OpenPrint(Value.getComPort())) {
                        if (chkTerminal.isSelected()) {
                            ProcessTerminal();
                        }
                        if (chkCashier.isSelected()) {
                            ProcessCashier();
                        }
                        if (chkGroup.isSelected()) {
                            ProcessGroup();
                        }
                        if (chkPlu.isSelected()) {
                            ProcessPlu();
                        }
                        if (chkHourly.isSelected()) {
                            ProcessHourly();
                        }
                        if (chkReceipt.isSelected()) {
                            ProcessInv();
                        }
                        if (chkVoid.isSelected()) {
                            ProcessVoid();
                        }
                        if (chkCredit.isSelected()) {
                            ProcessCredit();
                        }
                        if (chkGiftVoucher.isSelected()) {
                            ProcessGiftVoucher();
                        }

                        prn.closePrint();
                    } else {
                        chkTerminal.requestFocus();
                    }
                    prn.closePrint();
                }
            } else {
                MSG.WAR("ยังมียอดขายค้างอยู่ยังไม่ได้ชำระเงิน...กรุณาชำระเงินให้เรียบร้อยก่อนพิมพ์รายงาน ");
                chkTerminal.requestFocus();
            }
        } else {
            MSG.WAR("ไม่พบข้อมูลการขายสินค้าในแฟ้มข้อมูล...");
            chkTerminal.requestFocus();
        }
    }

    public boolean ChkSaleData() {
        boolean ReturnVal = false;
        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            ResultSet rs = stmt.executeQuery("select b_refno from billno limit 1");
            ReturnVal = rs.next();
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }

        return ReturnVal;
    }

    public boolean ChkSaleNoCash() {
        boolean ReturnVal = false;
        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            ResultSet rs = stmt.executeQuery("select r_refno from balance limit 1");
            ReturnVal = rs.next();
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }

        return ReturnVal;
    }

    public void ProcessTerminal() {
        FinalcialRec frec = new FinalcialRec();
        CreditRec[] CrArray;

        CrArray = null;
        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from billno where b_macno='" + Value.MACNO + "' order by b_refno";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.StBill = rs.getString("b_refno");
                
                frec.SpBill = rs.getString("b_refno");
                    if (!rs.getString("b_void").equals("V")) {
                        frec.Dept_Sum = frec.Dept_Sum + rs.getDouble("b_total");
                        if (rs.getDouble("b_serviceamt") != 0.0) {
                            frec.Service = frec.Service + rs.getDouble("b_serviceamt");
                            frec.ServiceCnt++;
                        }
                        if (rs.getDouble("b_crchargeamt1") != 0.0) {
                            frec.Charge = frec.Charge + rs.getDouble("b_crchargeamt1");
                            frec.ChargeCnt++;
                        }
                        if (rs.getDouble("b_memdiscamt") != 0.0) {
                            frec.Vip_Disc = frec.Vip_Disc + rs.getDouble("b_memdiscamt");
                            frec.Vip_DiscCnt++;
                        }
                        if (rs.getDouble("b_empdiscamt") != 0.0) {
                            frec.Emp_Disc = frec.Emp_Disc + rs.getDouble("b_empdiscamt");
                            frec.Emp_DiscCnt++;
                        }
                        if (rs.getDouble("b_fastdiscamt") != 0.0) {
                            frec.Fast_Disc = frec.Fast_Disc + rs.getDouble("b_fastdiscamt");
                            frec.Fast_DiscCnt++;
                        }
                        if (rs.getDouble("b_Traindiscamt") != 0.0) {
                            frec.Train_Disc = frec.Train_Disc + rs.getDouble("b_traindiscamt");
                            frec.Train_DiscCnt++;
                        }
                        if (rs.getDouble("b_subdiscamt") != 0.0) {
                            frec.Sub_Disc = frec.Sub_Disc + rs.getDouble("b_subdiscamt");
                            frec.Sub_DiscCnt++;
                        }
                        if (rs.getDouble("b_subdiscbath") != 0.0) {
                            frec.Gen_Refund = frec.Gen_Refund + rs.getDouble("b_subdiscbath");
                            frec.Gen_RefundCnt++;
                        }
                        if (rs.getDouble("b_cupondiscamt") != 0.0) {
                            frec.Cupon_Disc = frec.Cupon_Disc + rs.getDouble("b_cupondiscamt");
                            frec.Cupon_DiscCnt++;
                        }
                        if (rs.getDouble("b_prodiscamt") != 0.0) {
                            frec.Promotion = frec.Promotion + rs.getDouble("b_prodiscamt");
                            frec.PromotionCnt++;
                        }
                        if (rs.getDouble("b_spadiscamt") != 0.0) {
                            frec.Spacial = frec.Spacial + rs.getDouble("b_spadiscamt");
                            frec.SpacialCnt++;
                        }
                        if (rs.getDouble("b_itemdiscamt") != 0.0) {
                            frec.Item_Disc = frec.Item_Disc + rs.getDouble("b_itemdiscamt");
                            frec.Item_DiscCnt++;
                        }
                        frec.Net_Sale = frec.Net_Sale + (rs.getDouble("b_nettotal") + rs.getDouble("b_crchargeamt1"));
                        if (rs.getDouble("b_cash") != 0.0) {
                            frec.Cash = frec.Cash + rs.getDouble("b_cash");
                            frec.CashCnt++;
                        }
                        if (rs.getDouble("b_giftvoucher") != 0.0) {
                            frec.Gift = frec.Gift + rs.getDouble("b_giftvoucher");
                            frec.GiftCnt++;
                        }
                        if (rs.getDouble("b_earnest") != 0.0) {
                            frec.Earnest = frec.Earnest + rs.getDouble("b_earnest");
                            frec.EarnestCnt++;
                        }
                        if (rs.getDouble("b_accramt") != 0.0) {
                            frec.ArPayment = frec.ArPayment + rs.getDouble("b_accramt");
                            frec.ArPaymentCnt++;
                        }
                        if (rs.getDouble("b_cramt1") != 0.0) {
                            frec.Credit_Card = frec.Credit_Card + rs.getDouble("b_cramt1");
                            frec.Credit_CardCnt++;
                        }
                        frec.SaleVat = frec.SaleVat + rs.getDouble("b_netvat");
                        frec.SaleNonVat = frec.SaleNonVat + rs.getDouble("b_netnonvat");
                        frec.VatAmt = frec.VatAmt + rs.getDouble("b_vat");
                        frec.CntBill++;
                        if (rs.getDouble("b_food") != 0.0) {
                            frec.Food = frec.Food + rs.getDouble("b_food");
                        }
                        if (rs.getDouble("b_drink") != 0.0) {
                            frec.Drink = frec.Drink + rs.getDouble("b_drink");
                        }
                        if (rs.getDouble("b_product") != 0.0) {
                            frec.Product = frec.Product + rs.getDouble("b_product");
                        }
                        if (rs.getInt("b_cust") != 0) {
                            frec.Customer = frec.Customer + rs.getInt("b_cust");
                        }
                        if (rs.getString("b_etd").equals("E")) {
                            frec.Eat_In_Cnt++;
                            frec.Eat_In_Amt = frec.Eat_In_Amt + rs.getDouble("b_total");
                            frec.Eat_In_Cust = frec.Eat_In_Cust + rs.getInt("b_cust");
                            frec.Eat_In_Net = frec.Eat_In_Net + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("T")) {
                            frec.Take_AwayCnt++;
                            frec.Take_AwayAmt = frec.Take_AwayAmt + rs.getDouble("b_total");
                            frec.Take_AwayCust = frec.Take_AwayCust + rs.getInt("b_cust");
                            frec.Take_AwayNet = frec.Take_AwayNet + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("D")) {
                            frec.DeliveryCnt++;
                            frec.DeliveryAmt = frec.DeliveryAmt + rs.getDouble("b_total");
                            frec.DeliveryCust = frec.DeliveryCust + rs.getInt("b_cust");
                            frec.DeliveryNet = frec.DeliveryNet + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("P")) {
                            frec.PintoCnt++;
                            frec.PintoAmt = frec.PintoAmt + rs.getDouble("b_total");
                            frec.PintoCust = frec.PintoCust + rs.getInt("b_cust");
                            frec.PintoNet = frec.PintoNet + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("W")) {
                            frec.WholeCnt++;
                            frec.WholeAmt = frec.WholeAmt + rs.getDouble("b_total");
                            frec.WholeCust = frec.WholeCust + rs.getInt("b_cust");
                            frec.WholeNet = frec.WholeNet + rs.getDouble("b_nettotal");
                        }
                    } else {
                        frec.AmtBillVoid = frec.AmtBillVoid + (rs.getDouble("b_nettotal") + rs.getDouble("b_crchargeamt1"));
                        frec.CntBillVoid++;
                        frec.CntBill++;
                    }
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }

        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from paidiofile where (terminal='" + Value.MACNO + "') and (flage='I') ";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.Paid_InCnt++;
                    frec.Paid_In = frec.Paid_In + rs.getDouble("paidinamt");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }

        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from paidiofile where (terminal='" + Value.MACNO + "') and (flage='O') ";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.Paid_OutCnt++;
                    frec.Paid_Out = frec.Paid_Out + rs.getDouble("paidoutamt");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }

        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from t_sale where (r_void='V') and (macno='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.CntVoid++;
                    frec.VoidValue = frec.VoidValue + rs.getDouble("r_total");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }

        if (Value.printdriver) {
            prn.PrintTerminalEngForm(frec, CrArray, Value.MACNO);
        } else {
            PrintTerminal(frec, CrArray);
        }

    }

    public void PrintTerminal(FinalcialRec frec, CreditRec[] CrArray) {
        prn.InitPrinter();
        prn.print("   รายงานยอดการเงิน (Terminal Report)");
        prn.print("          Automatic X-Report)   ");
        prn.print("หมายเลขเครื่อง : " + Value.MACNO);
        Date dateP = new Date();
        prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("ยอดรวมค่าอาหาร                 ", 26) + PUtility.DataFull(DecFmt.format(frec.Food), 13));
        prn.print(PUtility.DataFullR("ยอดรวมค่าเครื่องดื่ม               ", 26) + PUtility.DataFull(DecFmt.format(frec.Drink), 13));
        prn.print(PUtility.DataFullR("ยอดรวมค่าสินค้าทั่วไป              ", 26) + PUtility.DataFull(DecFmt.format(frec.Product), 13));
        prn.print(PUtility.DataFullR("ยอดขายตามป้าย (Dept-Sum)       ", 26) + PUtility.DataFull(DecFmt.format(frec.Dept_Sum), 13));
        prn.print("                       ==============");
        prn.print(PUtility.DataFullR("ค่าบริการ Service       ", 20) + PUtility.DataFull(IntFmt.format(frec.ServiceCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Service), 13));
        prn.print(PUtility.DataFullR("Charge บัตรเครดิต       ", 20) + PUtility.DataFull(IntFmt.format(frec.ChargeCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Charge), 13));
        prn.print(PUtility.DataFullR("ส่วนลดสมาชิก VIP        ", 20) + PUtility.DataFull(IntFmt.format(frec.Vip_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Vip_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดเทศกาล           ", 20) + PUtility.DataFull(IntFmt.format(frec.Fast_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Fast_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดพนักงาน           ", 20) + PUtility.DataFull(IntFmt.format(frec.Emp_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Emp_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดพนักงาน Trainee   ", 20) + PUtility.DataFull(IntFmt.format(frec.Train_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Train_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดคูปอง              ", 20) + PUtility.DataFull(IntFmt.format(frec.Sub_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Sub_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดบาท               ", 20) + PUtility.DataFull(IntFmt.format(frec.Gen_RefundCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Gen_Refund), 13));
        prn.print(PUtility.DataFullR("ส่วนลด Promotion        ", 20) + PUtility.DataFull(IntFmt.format(frec.PromotionCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Promotion), 13));
        prn.print(PUtility.DataFullR("ส่วนลดพิเศษ (Special)    ", 20) + PUtility.DataFull(IntFmt.format(frec.SpacialCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Spacial), 13));
        prn.print(PUtility.DataFullR("ส่วนลดตามรายการ (Item)  ", 20) + PUtility.DataFull(IntFmt.format(frec.Item_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Item_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดบัตรคูปอง (Coupon)  ", 20) + PUtility.DataFull(IntFmt.format(frec.Cupon_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Cupon_Disc), 13));
        prn.print(PUtility.DataFullR("หักคืนเงินมัดจำ            ", 20) + PUtility.DataFull(IntFmt.format(frec.EarnestCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Earnest), 13));
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("ยอดขายสุทธิ (Net-Sales)           ", 26) + PUtility.DataFull(DecFmt.format(frec.Net_Sale), 13));
        prn.print("                       ==============");
        prn.print(PUtility.DataFullR("เงินสด Cash             ", 20) + PUtility.DataFull(IntFmt.format(frec.CashCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Cash), 13));
        prn.print(PUtility.DataFullR("บัตรกำนัล Gift Voucher   ", 20) + PUtility.DataFull(IntFmt.format(frec.GiftCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Gift), 13));
        prn.print(PUtility.DataFullR("ลูกหนี้การค้า              ", 20) + PUtility.DataFull(IntFmt.format(frec.ArPaymentCnt), 6) + PUtility.DataFull(DecFmt.format(frec.ArPayment), 13));
        if (frec.Credit_Card > 0) {
            if (CrArray != null) {
                int ArraySize = CrArray.length;
                for (int i = 0; i < ArraySize; i++) {
                    prn.print(PUtility.DataFullR(CrArray[i].CrName + "                     ", 20) + PUtility.DataFull(IntFmt.format(CrArray[i].CrCnt), 6) + PUtility.DataFull(DecFmt.format(CrArray[i].CrAmt), 13));
                }
            }
        }
        prn.print(PUtility.DataFullR("PAID-IN                ", 20) + PUtility.DataFull(IntFmt.format(frec.Paid_InCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Paid_In), 13));
        prn.print(PUtility.DataFullR("PAID-OUT               ", 20) + PUtility.DataFull(IntFmt.format(frec.Paid_OutCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Paid_Out), 13));
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("ยอดขายสินค้า/บริการ คิดภาษี       ", 26) + PUtility.DataFull(DecFmt.format(frec.SaleVat), 13));
        prn.print(PUtility.DataFullR("ยอดขายไม่คิดภาษี                ", 26) + PUtility.DataFull(DecFmt.format(frec.SaleNonVat), 13));
        prn.print(PUtility.DataFullR("ภาษีมูลค่าเพิ่ม (Vat)             ", 26) + PUtility.DataFull(DecFmt.format(frec.VatAmt), 13));
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("จำนวนลูกค้าทั้งสิ้น                ", 26) + PUtility.DataFull(IntFmt.format(frec.Customer), 8) + " คน");
        prn.print(PUtility.DataFullR("จำนวนใบกำกับภาษีอย่างย่อ         ", 26) + PUtility.DataFull(IntFmt.format(frec.CntBill), 8) + " ใบ");
        prn.print("    เลขที่เริ่มต้น  :" + frec.StBill + "   ถึง  : " + frec.SpBill);
        prn.print(PUtility.DataFullR("ใบกำกับภาษีที่ยกเลิก       ", 20) + PUtility.DataFull(IntFmt.format(frec.CntBillVoid), 6) + PUtility.DataFull(DecFmt.format(frec.AmtBillVoid), 13));
        prn.print(PUtility.DataFullR("มูลค่าสินค้าที่ทำการ Void   ", 20) + PUtility.DataFull(IntFmt.format(frec.CntVoid), 6) + PUtility.DataFull(DecFmt.format(frec.VoidValue), 13));
        prn.print("----------------------------------------");
        prn.print("ประเภทการขาย   บิล        ลูกค้า  จำนวนเงิน");
        prn.print("----------------------------------------");
        prn.print("Eat-In      " + PUtility.DataFull(IntFmt.format(frec.Eat_In_Cnt), 6) + PUtility.DataFull(IntFmt.format(frec.Eat_In_Cust), 8) + PUtility.DataFull(DecFmt.format(frec.Eat_In_Amt), 13));
        prn.print("Take Away   " + PUtility.DataFull(IntFmt.format(frec.Take_AwayCnt), 6) + PUtility.DataFull(IntFmt.format(frec.Take_AwayCust), 8) + PUtility.DataFull(DecFmt.format(frec.Take_AwayAmt), 13));
        prn.print("Delivery    " + PUtility.DataFull(IntFmt.format(frec.DeliveryCnt), 6) + PUtility.DataFull(IntFmt.format(frec.DeliveryCust), 8) + PUtility.DataFull(DecFmt.format(frec.DeliveryAmt), 13));
        prn.print("Pinto       " + PUtility.DataFull(IntFmt.format(frec.PintoCnt), 6) + PUtility.DataFull(IntFmt.format(frec.PintoCust), 8) + PUtility.DataFull(DecFmt.format(frec.PintoAmt), 13));
        prn.print("Whole Sales " + PUtility.DataFull(IntFmt.format(frec.WholeCnt), 6) + PUtility.DataFull(IntFmt.format(frec.WholeCust), 8) + PUtility.DataFull(DecFmt.format(frec.WholeAmt), 13));
        prn.print("----------------------------------------");
        prn.print("");
        prn.print("");
        prn.print("");

        Double SumAmt = 0.0;
        prn.print("    รายงานการรับชำระจากลูกหนี้ภายนอก ");
        prn.print("          AR Payment Report");
        prn.print("หมายเลขเครื่อง : " + Value.MACNO);
        prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
        prn.print("----------------------------------------");
        prn.print("AR Code    เลขที่ใบเสร็จรับเงิน/วันที่  จำนวนเงิน");
        prn.print("----------------------------------------");
        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from t_ar where (fat<>'V') and (terminal='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                prn.print(PUtility.DataFull(rs.getString("arcode"), 4) + "  " + rs.getString("billno") + "  " + ShowDatefmt.format(rs.getDate("billdate")) + PUtility.DataFull(DecFmt.format(rs.getDouble("amount")), 9));
                    SumAmt = SumAmt + rs.getDouble("amount");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }

        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("Total Amount  ", 26) + PUtility.DataFull(DecFmt.format(SumAmt), 13));
        prn.print("----------------------------------------");
        prn.print("");
        Double SumCash = 0.0;
        Double SumCupon = 0.0;
        int CntBill = 0;
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from billar where (fat<>'V') and (terminal='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                CntBill++;
                    SumCash = SumCash + rs.getDouble("cash");
                    SumCupon = SumCupon + rs.getDouble("cupon");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }
        
        prn.print(PUtility.DataFullR("     เงินสด Cash              ", 26) + PUtility.DataFull(DecFmt.format(SumCash), 13));
        prn.print(PUtility.DataFullR("     บัตรกำนัล Coupon          ", 26) + PUtility.DataFull(DecFmt.format(SumCupon), 13));
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from t_crar where (fat<>'V') and (terminal='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                prn.print(PUtility.DataFullR(PUtility.SeekCreditName(rs.getString("crcode") + "                "), 20) + PUtility.DataFull(IntFmt.format(rs.getInt("crcnt")), 6) + PUtility.DataFull(DecFmt.format(rs.getDouble("cramt")), 13));
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }

        prn.print("ยอดรับชำระ AR    : " + PUtility.DataFull(IntFmt.format(CntBill), 6));
        prn.print("----------------------------------------");
        prn.print(" ");
        prn.print("ยอดยกเลิกรายการ การรับชำระจากลูกหนี้ภายนอก");
        prn.print("AR Pay-No    Amount  Mac  User User Void ");
        prn.print("----------------------------------------");
        
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from billar where (fat='V') and (terminal='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                prn.print(rs.getString("ref_no") + "  " + PUtility.DataFull(DecFmt.format(rs.getDouble("stotal")), 9) + "  " + rs.getString("terminal") + "  " + PUtility.DataFull(rs.getString("cashier"), 6) + "  " + PUtility.DataFull(rs.getString("uservoid"), 6));
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }
        
        prn.print("----------------------------------------");
        prn.print("");
        prn.print("");
        prn.print("");
        prn.print(POSHW.getHeading1());
        prn.print(POSHW.getHeading2());
        prn.print(POSHW.getHeading3());
        prn.print(POSHW.getHeading4());
        prn.print("REG ID :" + Value.MACNO);
        prn.CutPaper();
    }

    public void ProcessCashier() {
        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select b_cashier,sum(b_nettotal) from billno where b_macno='" + Value.MACNO + "' group by b_cashier order by b_cashier";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                ProcessOneCashier(rs.getString("b_cashier"));
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }
    }

    public void ProcessOneCashier(String TempCashNo) {
        FinalcialRec frec = new FinalcialRec();
        CreditRec[] CrArray;

        CrArray = null;
        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select *from billno where (b_cashier='" + TempCashNo + "')  and (b_macno='" + Value.MACNO + "')  order by b_refno";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.StBill = rs.getString("b_refno");
                frec.Cashier1 = TempCashNo;
                
                frec.SpBill = rs.getString("b_refno");
                    if (!rs.getString("b_void").equals("V")) {
                        frec.Dept_Sum = frec.Dept_Sum + rs.getDouble("b_total");
                        if (rs.getDouble("b_serviceamt") != 0.0) {
                            frec.Service = frec.Service + rs.getDouble("b_serviceamt");
                            frec.ServiceCnt++;
                        }
                        if (rs.getDouble("b_crchargeamt1") != 0.0) {
                            frec.Charge = frec.Charge + rs.getDouble("b_crchargeamt1");
                            frec.ChargeCnt++;
                        }
                        if (rs.getDouble("b_memdiscamt") != 0.0) {
                            frec.Vip_Disc = frec.Vip_Disc + rs.getDouble("b_memdiscamt");
                            frec.Vip_DiscCnt++;
                        }
                        if (rs.getDouble("b_empdiscamt") != 0.0) {
                            frec.Emp_Disc = frec.Emp_Disc + rs.getDouble("b_empdiscamt");
                            frec.Emp_DiscCnt++;
                        }
                        if (rs.getDouble("b_fastdiscamt") != 0.0) {
                            frec.Fast_Disc = frec.Fast_Disc + rs.getDouble("b_fastdiscamt");
                            frec.Fast_DiscCnt++;
                        }
                        if (rs.getDouble("b_Traindiscamt") != 0.0) {
                            frec.Train_Disc = frec.Train_Disc + rs.getDouble("b_traindiscamt");
                            frec.Train_DiscCnt++;
                        }
                        if (rs.getDouble("b_subdiscamt") != 0.0) {
                            frec.Sub_Disc = frec.Sub_Disc + rs.getDouble("b_subdiscamt");
                            frec.Sub_DiscCnt++;
                        }
                        if (rs.getDouble("b_subdiscbath") != 0.0) {
                            frec.Gen_Refund = frec.Gen_Refund + rs.getDouble("b_subdiscbath");
                            frec.Gen_RefundCnt++;
                        }
                        if (rs.getDouble("b_cupondiscamt") != 0.0) {
                            frec.Cupon_Disc = frec.Cupon_Disc + rs.getDouble("b_cupondiscamt");
                            frec.Cupon_DiscCnt++;
                        }
                        if (rs.getDouble("b_prodiscamt") != 0.0) {
                            frec.Promotion = frec.Promotion + rs.getDouble("b_prodiscamt");
                            frec.PromotionCnt++;
                        }
                        if (rs.getDouble("b_spadiscamt") != 0.0) {
                            frec.Spacial = frec.Spacial + rs.getDouble("b_spadiscamt");
                            frec.SpacialCnt++;
                        }
                        if (rs.getDouble("b_itemdiscamt") != 0.0) {
                            frec.Item_Disc = frec.Item_Disc + rs.getDouble("b_itemdiscamt");
                            frec.Item_DiscCnt++;
                        }
                        frec.Net_Sale = frec.Net_Sale + (rs.getDouble("b_nettotal") + rs.getDouble("b_crchargeamt1"));
                        if (rs.getDouble("b_cash") != 0.0) {
                            frec.Cash = frec.Cash + rs.getDouble("b_cash");
                            frec.CashCnt++;
                        }
                        if (rs.getDouble("b_giftvoucher") != 0.0) {
                            frec.Gift = frec.Gift + rs.getDouble("b_giftvoucher");
                            frec.GiftCnt++;
                        }
                        if (rs.getDouble("b_earnest") != 0.0) {
                            frec.Earnest = frec.Earnest + rs.getDouble("b_earnest");
                            frec.EarnestCnt++;
                        }
                        if (rs.getDouble("b_accramt") != 0.0) {
                            frec.ArPayment = frec.ArPayment + rs.getDouble("b_accramt");
                            frec.ArPaymentCnt++;
                        }
                        if (rs.getDouble("b_cramt1") != 0.0) {
                            frec.Credit_Card = frec.Credit_Card + rs.getDouble("b_cramt1");
                            frec.Credit_CardCnt++;
                        }
                        frec.SaleVat = frec.SaleVat + rs.getDouble("b_netvat");
                        frec.SaleNonVat = frec.SaleNonVat + rs.getDouble("b_netnonvat");
                        frec.VatAmt = frec.VatAmt + rs.getDouble("b_vat");
                        frec.CntBill++;
                        if (rs.getDouble("b_food") != 0.0) {
                            frec.Food = frec.Food + rs.getDouble("b_food");
                        }
                        if (rs.getDouble("b_drink") != 0.0) {
                            frec.Drink = frec.Drink + rs.getDouble("b_drink");
                        }
                        if (rs.getDouble("b_product") != 0.0) {
                            frec.Product = frec.Product + rs.getDouble("b_product");
                        }
                        if (rs.getInt("b_cust") != 0) {
                            frec.Customer = frec.Customer + rs.getInt("b_cust");
                        }
                        if (rs.getString("b_etd").equals("E")) {
                            frec.Eat_In_Cnt++;
                            frec.Eat_In_Amt = frec.Eat_In_Amt + rs.getDouble("b_total");
                            frec.Eat_In_Cust = frec.Eat_In_Cust + rs.getInt("b_cust");
                            frec.Eat_In_Net = frec.Eat_In_Net + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("T")) {
                            frec.Take_AwayCnt++;
                            frec.Take_AwayAmt = frec.Take_AwayAmt + rs.getDouble("b_total");
                            frec.Take_AwayCust = frec.Take_AwayCust + rs.getInt("b_cust");
                            frec.Take_AwayNet = frec.Take_AwayNet + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("D")) {
                            frec.DeliveryCnt++;
                            frec.DeliveryAmt = frec.DeliveryAmt + rs.getDouble("b_total");
                            frec.DeliveryCust = frec.DeliveryCust + rs.getInt("b_cust");
                            frec.DeliveryNet = frec.DeliveryNet + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("P")) {
                            frec.PintoCnt++;
                            frec.PintoAmt = frec.PintoAmt + rs.getDouble("b_total");
                            frec.PintoCust = frec.PintoCust + rs.getInt("b_cust");
                            frec.PintoNet = frec.PintoNet + rs.getDouble("b_nettotal");
                        }
                        if (rs.getString("b_etd").equals("W")) {
                            frec.WholeCnt++;
                            frec.WholeAmt = frec.WholeAmt + rs.getDouble("b_total");
                            frec.WholeCust = frec.WholeCust + rs.getInt("b_cust");
                            frec.WholeNet = frec.WholeNet + rs.getDouble("b_nettotal");
                        }
                    } else {
                        frec.AmtBillVoid = frec.AmtBillVoid + (rs.getDouble("b_nettotal") + rs.getDouble("b_crchargeamt1"));
                        frec.CntBillVoid++;
                        frec.CntBill++;
                    }
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }

        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from paidiofile where (cashier='" + TempCashNo + "') and (flage='I') and (terminal='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.Paid_InCnt++;
                    frec.Paid_In = frec.Paid_In + rs.getDouble("paidinamt");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }

        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from paidiofile where (cashier='" + TempCashNo + "') and (flage='O') and (terminal='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.Paid_OutCnt++;
                    frec.Paid_Out = frec.Paid_Out + rs.getDouble("paidoutamt");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }
        
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from t_sale where (r_void='V') and (cashier='" + TempCashNo + "')  and (macno='" + Value.MACNO + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                frec.CntVoid++;
                    frec.VoidValue = frec.VoidValue + rs.getDouble("r_total");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }
        
        PrintCashier(frec, CrArray, false);
    }

    public void PrintCashier(FinalcialRec frec, CreditRec[] CrArray, boolean ChkVoid) {
        prn.InitPrinter();
        prn.print("   รายงานพนักงานขาย (Cashier Report)");
        prn.print("        (Automatic Xreport)");
        prn.print("หมายเลขเครื่อง : " + Value.MACNO);
        prn.print("รหัสพนักงาน    : " + frec.Cashier1);
        Date dateP = new Date();
        prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("ยอดรวมค่าอาหาร                 ", 26) + PUtility.DataFull(DecFmt.format(frec.Food), 13));
        prn.print(PUtility.DataFullR("ยอดรวมค่าเครื่องดื่ม               ", 26) + PUtility.DataFull(DecFmt.format(frec.Drink), 13));
        prn.print(PUtility.DataFullR("ยอดรวมค่าสินค้าทั่วไป              ", 26) + PUtility.DataFull(DecFmt.format(frec.Product), 13));
        prn.print(PUtility.DataFullR("ยอดขายตามป้าย (Dept-Sum)       ", 26) + PUtility.DataFull(DecFmt.format(frec.Dept_Sum), 13));
        prn.print("                       ==============");
        prn.print(PUtility.DataFullR("ค่าบริการ Service       ", 20) + PUtility.DataFull(IntFmt.format(frec.ServiceCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Service), 13));
        prn.print(PUtility.DataFullR("Charge บัตรเครดิต       ", 20) + PUtility.DataFull(IntFmt.format(frec.ChargeCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Charge), 13));
        prn.print(PUtility.DataFullR("ส่วนลดสมาชิก VIP        ", 20) + PUtility.DataFull(IntFmt.format(frec.Vip_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Vip_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดเทศกาล           ", 20) + PUtility.DataFull(IntFmt.format(frec.Fast_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Fast_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดพนักงาน           ", 20) + PUtility.DataFull(IntFmt.format(frec.Emp_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Emp_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดพนักงาน Trainee   ", 20) + PUtility.DataFull(IntFmt.format(frec.Train_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Train_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดคูปอง              ", 20) + PUtility.DataFull(IntFmt.format(frec.Sub_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Sub_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดบาท               ", 20) + PUtility.DataFull(IntFmt.format(frec.Gen_RefundCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Gen_Refund), 13));
        prn.print(PUtility.DataFullR("ส่วนลด Promotion        ", 20) + PUtility.DataFull(IntFmt.format(frec.PromotionCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Promotion), 13));
        prn.print(PUtility.DataFullR("ส่วนลดพิเศษ (Special)    ", 20) + PUtility.DataFull(IntFmt.format(frec.SpacialCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Spacial), 13));
        prn.print(PUtility.DataFullR("ส่วนลดตามรายการ (Item)  ", 20) + PUtility.DataFull(IntFmt.format(frec.Item_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Item_Disc), 13));
        prn.print(PUtility.DataFullR("ส่วนลดบัตรคูปอง (Coupon)  ", 20) + PUtility.DataFull(IntFmt.format(frec.Cupon_DiscCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Cupon_Disc), 13));
        prn.print(PUtility.DataFullR("หักคืนเงินมัดจำ            ", 20) + PUtility.DataFull(IntFmt.format(frec.EarnestCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Earnest), 13));
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("ยอดขายสุทธิ (Net-Sales)           ", 26) + PUtility.DataFull(DecFmt.format(frec.Net_Sale), 13));
        prn.print("                       ==============");
        prn.print(PUtility.DataFullR("เงินสด Cash             ", 20) + PUtility.DataFull(IntFmt.format(frec.CashCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Cash), 13));
        prn.print(PUtility.DataFullR("บัตรกำนัล Gift Voucher   ", 20) + PUtility.DataFull(IntFmt.format(frec.GiftCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Gift), 13));
        prn.print(PUtility.DataFullR("ลูกหนี้การค้า              ", 20) + PUtility.DataFull(IntFmt.format(frec.ArPaymentCnt), 6) + PUtility.DataFull(DecFmt.format(frec.ArPayment), 13));
        if (frec.Credit_Card > 0) {
            if (CrArray != null) {
                int ArraySize = CrArray.length;
                for (int i = 0; i < ArraySize; i++) {
                    prn.print(PUtility.DataFullR(CrArray[i].CrName + "                     ", 20) + PUtility.DataFull(IntFmt.format(CrArray[i].CrCnt), 6) + PUtility.DataFull(DecFmt.format(CrArray[i].CrAmt), 13));
                }
            }
        }
        prn.print(PUtility.DataFullR("PAID-IN                ", 20) + PUtility.DataFull(IntFmt.format(frec.Paid_InCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Paid_In), 13));
        prn.print(PUtility.DataFullR("PAID-OUT               ", 20) + PUtility.DataFull(IntFmt.format(frec.Paid_OutCnt), 6) + PUtility.DataFull(DecFmt.format(frec.Paid_Out), 13));
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("ยอดขายสินค้า/บริการ คิดภาษี       ", 26) + PUtility.DataFull(DecFmt.format(frec.SaleVat), 13));
        prn.print(PUtility.DataFullR("ยอดขายไม่คิดภาษี                ", 26) + PUtility.DataFull(DecFmt.format(frec.SaleNonVat), 13));
        prn.print(PUtility.DataFullR("ภาษีมูลค่าเพิ่ม (Vat)             ", 26) + PUtility.DataFull(DecFmt.format(frec.VatAmt), 13));
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("จำนวนลูกค้าทั้งสิ้น                ", 26) + PUtility.DataFull(IntFmt.format(frec.Customer), 8) + " คน");
        prn.print(PUtility.DataFullR("จำนวนใบกำกับภาษีอย่างย่อ         ", 26) + PUtility.DataFull(IntFmt.format(frec.CntBill), 8) + " ใบ");
        prn.print("    เลขที่เริ่มต้น  :" + frec.StBill + "   ถึง  : " + frec.SpBill);
        prn.print(PUtility.DataFullR("ใบกำกับภาษีที่ยกเลิก       ", 20) + PUtility.DataFull(IntFmt.format(frec.CntBillVoid), 6) + PUtility.DataFull(DecFmt.format(frec.AmtBillVoid), 13));
        prn.print(PUtility.DataFullR("มูลค่าสินค้าที่ทำการ Void   ", 20) + PUtility.DataFull(IntFmt.format(frec.CntVoid), 6) + PUtility.DataFull(DecFmt.format(frec.VoidValue), 13));
        prn.print("----------------------------------------");
        prn.print("ประเภทการขาย   บิล        ลูกค้า  จำนวนเงิน");
        prn.print("----------------------------------------");
        prn.print("Eat-In      " + PUtility.DataFull(IntFmt.format(frec.Eat_In_Cnt), 6) + PUtility.DataFull(IntFmt.format(frec.Eat_In_Cust), 8) + PUtility.DataFull(DecFmt.format(frec.Eat_In_Amt), 13));
        prn.print("Take Away   " + PUtility.DataFull(IntFmt.format(frec.Take_AwayCnt), 6) + PUtility.DataFull(IntFmt.format(frec.Take_AwayCust), 8) + PUtility.DataFull(DecFmt.format(frec.Take_AwayAmt), 13));
        prn.print("Delivery    " + PUtility.DataFull(IntFmt.format(frec.DeliveryCnt), 6) + PUtility.DataFull(IntFmt.format(frec.DeliveryCust), 8) + PUtility.DataFull(DecFmt.format(frec.DeliveryAmt), 13));
        prn.print("Pinto       " + PUtility.DataFull(IntFmt.format(frec.PintoCnt), 6) + PUtility.DataFull(IntFmt.format(frec.PintoCust), 8) + PUtility.DataFull(DecFmt.format(frec.PintoAmt), 13));
        prn.print("Whole Sales " + PUtility.DataFull(IntFmt.format(frec.WholeCnt), 6) + PUtility.DataFull(IntFmt.format(frec.WholeCust), 8) + PUtility.DataFull(DecFmt.format(frec.WholeAmt), 13));
        prn.print("----------------------------------------");
        prn.print("");
        prn.print("");
        prn.print("");

        Double SumAmt = 0.0;
        prn.print("    รายงานการรับชำระจากลูกหนี้ภายนอก ");
        prn.print("          AR Payment Report");
        prn.print("รหัสพนักงานขาย : " + frec.Cashier1);
        prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
        prn.print("----------------------------------------");
        prn.print("AR Code    เลขที่ใบเสร็จรับเงิน/วันที่  จำนวนเงิน");
        prn.print("----------------------------------------");

        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from t_ar where (fat<>'V') and (cashier='" + frec.Cashier1 + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                prn.print(PUtility.DataFull(rs.getString("arcode"), 4) + "  " + rs.getString("billno") + "  " + ShowDatefmt.format(rs.getDate("billdate")) + PUtility.DataFull(DecFmt.format(rs.getDouble("amount")), 9));
                    SumAmt = SumAmt + rs.getDouble("amount");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }
        prn.print("----------------------------------------");
        prn.print(PUtility.DataFullR("Total Amount  ", 26) + PUtility.DataFull(DecFmt.format(SumAmt), 13));
        prn.print("----------------------------------------");
        prn.print("");
        Double SumCash = 0.0;
        Double SumCupon = 0.0;
        int CntBill = 0;
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from billar where (fat<>'V') and (cashier='" + frec.Cashier1 + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                CntBill++;
                    SumCash = SumCash + rs.getDouble("cash");
                    SumCupon = SumCupon + rs.getDouble("cupon");
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }
        
        prn.print(PUtility.DataFullR("     เงินสด Cash              ", 26) + PUtility.DataFull(DecFmt.format(SumCash), 13));
        prn.print(PUtility.DataFullR("     บัตรกำนัล Coupon          ", 26) + PUtility.DataFull(DecFmt.format(SumCupon), 13));
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from t_crar where (fat<>'V') and (cashier='" + frec.Cashier1 + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                prn.print(PUtility.DataFullR(PUtility.SeekCreditName(rs.getString("crcode") + "                "), 20) + PUtility.DataFull(IntFmt.format(rs.getInt("crcnt")), 6) + PUtility.DataFull(DecFmt.format(rs.getDouble("cramt")), 13));
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }
        
        prn.print("ยอดรับชำระ AR    : " + PUtility.DataFull(IntFmt.format(CntBill), 6));
        prn.print("----------------------------------------");
        prn.print(" ");
        prn.print("ยอดยกเลิกรายการ การรับชำระจากลูกหนี้ภายนอก");
        prn.print("AR Pay-No    Amount  Mac  User User Void ");
        prn.print("----------------------------------------");
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select * from billar where (fat='V') and (cashier='" + frec.Cashier1 + "')";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            while(rs.next()){
                prn.print(rs.getString("ref_no") + "  " + PUtility.DataFull(DecFmt.format(rs.getDouble("stotal")), 9) + "  " + rs.getString("terminal") + "  " + PUtility.DataFull(rs.getString("cashier"), 6) + "  " + PUtility.DataFull(rs.getString("uservoid"), 6));
            }
            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        }
        
        prn.print("----------------------------------------");
        prn.print("");
        prn.print("");
        prn.print("");
        if (ChkVoid) {
            prn.print("    รายงานการทำรายการ Void ");
            prn.print("           Void Report");
            prn.print("รหัสพนักงานขาย : " + frec.Cashier1);

            prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
            prn.print("----------------------------------------");
            prn.print("Mac Cashier Table Time  User-Void T_Void");
            prn.print("    Ref-No  PLU-Code       Qty    Amount");
            prn.print("----------------------------------------");
            int SumVoid = 0;
            Double SumAmount = 0.0;
            try {
                Statement stmt = mysql.getConnection().createStatement();
                String SqlQuery = "select * from t_sale where (r_void='V') and (cashier='" + frec.Cashier1 + "')";
                ResultSet rs = stmt.executeQuery(SqlQuery);
                while(rs.next()){
                    prn.print(rs.getString("macno") + " " + PUtility.DataFullR(rs.getString("cashier"), 6) + " " + PUtility.DataFullR(rs.getString("r_table"), 5) + " " + PUtility.DataFullR(rs.getString("r_time"), 6) + "  " + PUtility.DataFullR(rs.getString("r_voiduser"), 10) + " " + PUtility.DataFullR(rs.getString("r_voidtime"), 6));
                        prn.print("     " + PUtility.DataFullR(rs.getString("r_pname"), 35));
                        prn.print("     " + rs.getString("r_refno") + " " + PUtility.DataFull(rs.getString("r_plucode"), 13) + " " + PUtility.DataFull(IntFmt.format(rs.getDouble("r_quan")), 4) + " " + PUtility.DataFull(DecFmt.format(rs.getDouble("r_total")), 8));
                        SumVoid++;
                        SumAmount = SumAmount + rs.getDouble("r_total");
                }
                rs.close();
                stmt.close();
            } catch (SQLException e) {
                MSG.ERR(e.getMessage());
                AppLogUtil.log(AutoXRep.class, "error", e);
            }
            
            prn.print("----------------------------------------");
            prn.print("จำนวน Void :" + PUtility.DataFull(IntFmt.format(SumVoid), 5) + "  จำนวนเงิน :" + PUtility.DataFull(DecFmt.format(SumAmount), 11));
            prn.print("----------------------------------------");
            prn.print("");
            prn.print("");
            prn.print("");
        }
        prn.print(POSHW.getHeading1());
        prn.print(POSHW.getHeading2());
        prn.print(POSHW.getHeading3());
        prn.print(POSHW.getHeading4());
        //Print_Str(" ");
        prn.print("REG ID :" + Value.MACNO);
        prn.CutPaper();

        mysql.close();
    }

    public void ProcessGroup() {
        String TempGroup;
        int ArraySize = 0;
        PluRec[] GArray;
        GArray = new PluRec[1];
        ArraySize = 0;

        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select *from t_sale where (macno='" + Value.MACNO + "') "
                    + "and (r_void<>'V') and (r_refund<>'V') Order by r_group";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            TempGroup = "";
            Double SumEQty = 0.0;
            Double SumEAmt = 0.0;
            Double SumTQty = 0.0;
            Double SumTAmt = 0.0;
            Double SumDQty = 0.0;
            Double SumDAmt = 0.0;
            Double SumPQty = 0.0;
            Double SumPAmt = 0.0;
            Double SumWQty = 0.0;
            Double SumWAmt = 0.0;
            Double SumSQty = 0.0;
            Double SumSAmt = 0.0;
            PluRec GroupRec = new PluRec();
            GroupRec.MacNo1 = "";
            GroupRec.MacNo2 = "";
            GroupRec.Cashier1 = "";
            GroupRec.Cashier2 = "";
            GroupRec.Group1 = "";
            GroupRec.Group2 = "";
            GroupRec.Plu1 = "";
            GroupRec.Plu2 = "";
            GroupRec.GroupCode = TempGroup;
            GroupRec.GroupName = PUtility.SeekGroupName(TempGroup);
            GroupRec.PCode = "";
            GroupRec.PName = "";

            GroupRec.E_Qty = GroupRec.E_Qty + SumEQty;
            GroupRec.E_Amt = GroupRec.E_Amt + SumEAmt;

            GroupRec.T_Qty = GroupRec.T_Qty + SumTQty;
            GroupRec.T_Amt = GroupRec.T_Amt + SumTAmt;

            GroupRec.D_Qty = GroupRec.D_Qty + SumDQty;
            GroupRec.D_Amt = GroupRec.D_Amt + SumDAmt;

            GroupRec.P_Qty = GroupRec.P_Qty + SumPQty;
            GroupRec.P_Amt = GroupRec.P_Amt + SumPAmt;

            GroupRec.W_Qty = GroupRec.W_Qty + SumWQty;
            GroupRec.W_Amt = GroupRec.W_Amt + SumWAmt;

            GroupRec.S_Qty = GroupRec.S_Qty + SumSQty;
            GroupRec.S_Amt = GroupRec.S_Amt + SumSAmt;
            GArray[ArraySize] = GroupRec;
            
            while(rs.next()){
                TempGroup = rs.getString("r_group");
                
                if (!TempGroup.equals(rs.getString("r_group"))) {
                        GroupRec = new PluRec();
                        GroupRec.MacNo1 = "";
                        GroupRec.MacNo2 = "";
                        GroupRec.Cashier1 = "";
                        GroupRec.Cashier2 = "";
                        GroupRec.Group1 = "";
                        GroupRec.Group2 = "";
                        GroupRec.Plu1 = "";
                        GroupRec.Plu2 = "";
                        GroupRec.GroupCode = TempGroup;
                        GroupRec.GroupName = PUtility.SeekGroupName(TempGroup);
                        GroupRec.PCode = "";
                        GroupRec.PName = "";

                        GroupRec.E_Qty = GroupRec.E_Qty + SumEQty;
                        GroupRec.E_Amt = GroupRec.E_Amt + SumEAmt;

                        GroupRec.T_Qty = GroupRec.T_Qty + SumTQty;
                        GroupRec.T_Amt = GroupRec.T_Amt + SumTAmt;

                        GroupRec.D_Qty = GroupRec.D_Qty + SumDQty;
                        GroupRec.D_Amt = GroupRec.D_Amt + SumDAmt;

                        GroupRec.P_Qty = GroupRec.P_Qty + SumPQty;
                        GroupRec.P_Amt = GroupRec.P_Amt + SumPAmt;

                        GroupRec.W_Qty = GroupRec.W_Qty + SumWQty;
                        GroupRec.W_Amt = GroupRec.W_Amt + SumWAmt;

                        GroupRec.S_Qty = GroupRec.S_Qty + SumSQty;
                        GroupRec.S_Amt = GroupRec.S_Amt + SumSAmt;
                        if (ArraySize == 0) {
                            GArray[ArraySize] = GroupRec;
                            ArraySize = GArray.length;
                        } else {
                            GArray = PUtility.addPluArray(GArray);
                            ArraySize = GArray.length;
                            GArray[ArraySize - 1] = GroupRec;
                        }
                        TempGroup = rs.getString("r_group");
                        SumEQty = 0.0;
                        SumEAmt = 0.0;
                        SumTQty = 0.0;
                        SumTAmt = 0.0;
                        SumDQty = 0.0;
                        SumDAmt = 0.0;
                        SumPQty = 0.0;
                        SumPAmt = 0.0;
                        SumWQty = 0.0;
                        SumWAmt = 0.0;
                        SumSQty = 0.0;
                        SumSAmt = 0.0;
                    }
                    if (rs.getString("r_etd").equals("E")) {
                        SumEQty = SumEQty + rs.getDouble("r_quan");
                        SumEAmt = SumEAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("T")) {
                        SumTQty = SumTQty + rs.getDouble("r_quan");
                        SumTAmt = SumTAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("D")) {
                        SumDQty = SumDQty + rs.getDouble("r_quan");
                        SumDAmt = SumDAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("P")) {
                        SumPQty = SumPQty + rs.getDouble("r_quan");
                        SumPAmt = SumPAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("W")) {
                        SumWQty = SumWQty + rs.getDouble("r_quan");
                        SumWAmt = SumWAmt + rs.getDouble("r_total");
                    }
                    SumSQty = SumSQty + rs.getDouble("r_quan");
                    SumSAmt = SumSAmt + rs.getDouble("r_total");
            }
            if (SumSQty > 0) {
                    GroupRec = new PluRec();
                    GroupRec.MacNo1 = "";
                    GroupRec.MacNo2 = "";
                    GroupRec.Cashier1 = "";
                    GroupRec.Cashier2 = "";
                    GroupRec.Group1 = "";
                    GroupRec.Group2 = "";
                    GroupRec.Plu1 = "";
                    GroupRec.Plu2 = "";
                    GroupRec.GroupCode = TempGroup;
                    GroupRec.GroupName = PUtility.SeekGroupName(TempGroup);
                    GroupRec.PCode = "";
                    GroupRec.PName = "";

                    GroupRec.E_Qty = GroupRec.E_Qty + SumEQty;
                    GroupRec.E_Amt = GroupRec.E_Amt + SumEAmt;

                    GroupRec.T_Qty = GroupRec.T_Qty + SumTQty;
                    GroupRec.T_Amt = GroupRec.T_Amt + SumTAmt;

                    GroupRec.D_Qty = GroupRec.D_Qty + SumDQty;
                    GroupRec.D_Amt = GroupRec.D_Amt + SumDAmt;

                    GroupRec.P_Qty = GroupRec.P_Qty + SumPQty;
                    GroupRec.P_Amt = GroupRec.P_Amt + SumPAmt;

                    GroupRec.W_Qty = GroupRec.W_Qty + SumWQty;
                    GroupRec.W_Amt = GroupRec.W_Amt + SumWAmt;

                    GroupRec.S_Qty = GroupRec.S_Qty + SumSQty;
                    GroupRec.S_Amt = GroupRec.S_Amt + SumSAmt;
                    if (ArraySize == 0) {
                        GArray[ArraySize] = GroupRec;
                        ArraySize = GArray.length;
                    } else {
                        GArray = PUtility.addPluArray(GArray);
                        ArraySize = GArray.length;
                        GArray[ArraySize - 1] = GroupRec;
                    }
                }

            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }
        
        if (Value.printdriver) {
            prn.PrintGroupDriver(GArray);
        } else {
            PrintGroup(GArray);
        }

    }

    public void PrintGroup(PluRec[] GArray) {
        Double SumEQty = 0.0;
        Double SumEAmt = 0.0;
        Double SumTQty = 0.0;
        Double SumTAmt = 0.0;
        Double SumDQty = 0.0;
        Double SumDAmt = 0.0;
        Double SumPQty = 0.0;
        Double SumPAmt = 0.0;
        Double SumWQty = 0.0;
        Double SumWAmt = 0.0;
        Double SumSQty = 0.0;
        Double SumSAmt = 0.0;
        int ArraySize = GArray.length;

        prn.InitPrinter();
        prn.print("         รายงานการขายตามกลุ่มสินค้า");
        prn.print("           (Department Report)");
        prn.print("           (Automatic XReport)");
        prn.print("หมายเลขเครื่อง :" + Value.MACNO);
        prn.print(" ");
        Date dateP = new Date();
        prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
        prn.print("----------------------------------------");
        prn.print("รายละเอียด");
        prn.print("    .....EAT IN.....   ...TAKE AWAY.....");
        prn.print("    ....DELIVERY....   .....PINTO.......");
        prn.print("    ...WHOLE SALE...   .....TOTAL.......");
        prn.print("----------------------------------------");
        if (GArray[0].S_Qty > 0) {
            for (int i = 0; i < ArraySize; i++) {

                prn.print(PUtility.DataFullR(GArray[i].GroupCode, 4) + "  " + GArray[i].GroupName);
                prn.print(PUtility.DataFull(IntFmt.format(GArray[i].E_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].E_Amt), 12) + PUtility.DataFull(IntFmt.format(GArray[i].T_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].T_Amt), 12));
                prn.print(PUtility.DataFull(IntFmt.format(GArray[i].D_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].D_Amt), 12) + PUtility.DataFull(IntFmt.format(GArray[i].P_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].P_Amt), 12));
                prn.print(PUtility.DataFull(IntFmt.format(GArray[i].W_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].W_Amt), 12) + PUtility.DataFull(IntFmt.format(GArray[i].S_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].S_Amt), 12));

                SumEQty = SumEQty + GArray[i].E_Qty;
                SumEAmt = SumEAmt + GArray[i].E_Amt;
                SumTQty = SumTQty + GArray[i].T_Qty;
                SumTAmt = SumTAmt + GArray[i].T_Amt;
                SumDQty = SumDQty + GArray[i].D_Qty;
                SumDAmt = SumDAmt + GArray[i].D_Amt;
                SumPQty = SumPQty + GArray[i].P_Qty;
                SumPAmt = SumPAmt + GArray[i].P_Amt;
                SumWQty = SumWQty + GArray[i].W_Qty;
                SumWAmt = SumWAmt + GArray[i].W_Amt;
                SumSQty = SumSQty + GArray[i].S_Qty;
                SumSAmt = SumSAmt + GArray[i].S_Amt;
            }
        }
        prn.print("----------------------------------------");
        prn.print("***Subtotal***");
        prn.print(PUtility.DataFull(IntFmt.format(SumEQty), 6) + PUtility.DataFull(DecFmt.format(SumEAmt), 12) + PUtility.DataFull(IntFmt.format(SumTQty), 6) + PUtility.DataFull(DecFmt.format(SumTAmt), 12));
        prn.print(PUtility.DataFull(IntFmt.format(SumDQty), 6) + PUtility.DataFull(DecFmt.format(SumDAmt), 12) + PUtility.DataFull(IntFmt.format(SumPQty), 6) + PUtility.DataFull(DecFmt.format(SumPAmt), 12));
        prn.print(PUtility.DataFull(IntFmt.format(SumWQty), 6) + PUtility.DataFull(DecFmt.format(SumWAmt), 12) + PUtility.DataFull(IntFmt.format(SumSQty), 6) + PUtility.DataFull(DecFmt.format(SumSAmt), 12));

        prn.print("----------------------------------------");
        prn.print(" ");
        prn.print(" ");
        prn.print(" ");
        prn.print(POSHW.getHeading1());
        prn.print(POSHW.getHeading2());
        prn.print(POSHW.getHeading3());
        prn.print(POSHW.getHeading4());
        prn.print("REG ID :" + Value.MACNO);
        prn.CutPaper();

    }

    public void ProcessPlu() {
        String TempGroup;
        String TempPlu;
        String TempName;
        int ArraySize;
        PluRec[] GArray;
        GArray = new PluRec[1];
        ArraySize = 0;

        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "select *from t_sale where (macno='" + Value.MACNO + "')"
                    + "and (r_void<>'V') and (r_refund<>'V') Order by r_group,r_plucode";
            ResultSet rs = stmt.executeQuery(SqlQuery);
            TempGroup = "";
            TempPlu = "";
            TempName = "";
            Double SumEQty = 0.0;
            Double SumEAmt = 0.0;
            Double SumTQty = 0.0;
            Double SumTAmt = 0.0;
            Double SumDQty = 0.0;
            Double SumDAmt = 0.0;
            Double SumPQty = 0.0;
            Double SumPAmt = 0.0;
            Double SumWQty = 0.0;
            Double SumWAmt = 0.0;
            Double SumSQty = 0.0;
            Double SumSAmt = 0.0;
            PluRec GroupRec = new PluRec();
            GroupRec.MacNo1 = "";
            GroupRec.MacNo2 = "";
            GroupRec.Cashier1 = "";
            GroupRec.Cashier2 = "";
            GroupRec.Group1 = "";
            GroupRec.Group2 = "";
            GroupRec.Plu1 = "";
            GroupRec.Plu2 = "";
            GroupRec.GroupCode = TempGroup;
            GroupRec.GroupName = PUtility.SeekGroupName(TempGroup);
            GroupRec.PCode = TempPlu;
            GroupRec.PName = TempName;

            GroupRec.E_Qty = GroupRec.E_Qty + SumEQty;
            GroupRec.E_Amt = GroupRec.E_Amt + SumEAmt;

            GroupRec.T_Qty = GroupRec.T_Qty + SumTQty;
            GroupRec.T_Amt = GroupRec.T_Amt + SumTAmt;

            GroupRec.D_Qty = GroupRec.D_Qty + SumDQty;
            GroupRec.D_Amt = GroupRec.D_Amt + SumDAmt;

            GroupRec.P_Qty = GroupRec.P_Qty + SumPQty;
            GroupRec.P_Amt = GroupRec.P_Amt + SumPAmt;

            GroupRec.W_Qty = GroupRec.W_Qty + SumWQty;
            GroupRec.W_Amt = GroupRec.W_Amt + SumWAmt;

            GroupRec.S_Qty = GroupRec.S_Qty + SumSQty;
            GroupRec.S_Amt = GroupRec.S_Amt + SumSAmt;

            GArray[0] = GroupRec;
            
            while(rs.next()){
                TempGroup = rs.getString("r_group");
                TempPlu = rs.getString("r_plucode");
                TempName = rs.getString("r_pname");
                
                if (!TempPlu.equals(rs.getString("r_plucode"))) {
                        GroupRec = new PluRec();
                        GroupRec.MacNo1 = "";
                        GroupRec.MacNo2 = "";
                        GroupRec.Cashier1 = "";
                        GroupRec.Cashier2 = "";
                        GroupRec.Group1 = "";
                        GroupRec.Group2 = "";
                        GroupRec.Plu1 = "";
                        GroupRec.Plu2 = "";
                        GroupRec.GroupCode = TempGroup;
                        GroupRec.GroupName = PUtility.SeekGroupName(TempGroup);
                        GroupRec.PCode = TempPlu;
                        GroupRec.PName = TempName;

                        GroupRec.E_Qty = GroupRec.E_Qty + SumEQty;
                        GroupRec.E_Amt = GroupRec.E_Amt + SumEAmt;

                        GroupRec.T_Qty = GroupRec.T_Qty + SumTQty;
                        GroupRec.T_Amt = GroupRec.T_Amt + SumTAmt;

                        GroupRec.D_Qty = GroupRec.D_Qty + SumDQty;
                        GroupRec.D_Amt = GroupRec.D_Amt + SumDAmt;

                        GroupRec.P_Qty = GroupRec.P_Qty + SumPQty;
                        GroupRec.P_Amt = GroupRec.P_Amt + SumPAmt;

                        GroupRec.W_Qty = GroupRec.W_Qty + SumWQty;
                        GroupRec.W_Amt = GroupRec.W_Amt + SumWAmt;

                        GroupRec.S_Qty = GroupRec.S_Qty + SumSQty;
                        GroupRec.S_Amt = GroupRec.S_Amt + SumSAmt;
                        if (ArraySize == 0) {
                            GArray[ArraySize] = GroupRec;
                            ArraySize = GArray.length;
                        } else {
                            GArray = PUtility.addPluArray(GArray);
                            ArraySize = GArray.length;
                            GArray[ArraySize - 1] = GroupRec;
                        }
                        TempGroup = rs.getString("r_group");
                        TempPlu = rs.getString("r_plucode");
                        TempName = rs.getString("r_pname");
                        SumEQty = 0.0;
                        SumEAmt = 0.0;
                        SumTQty = 0.0;
                        SumTAmt = 0.0;
                        SumDQty = 0.0;
                        SumDAmt = 0.0;
                        SumPQty = 0.0;
                        SumPAmt = 0.0;
                        SumWQty = 0.0;
                        SumWAmt = 0.0;
                        SumSQty = 0.0;
                        SumSAmt = 0.0;
                    }
                    if (rs.getString("r_etd").equals("E")) {
                        SumEQty = SumEQty + rs.getDouble("r_quan");
                        SumEAmt = SumEAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("T")) {
                        SumTQty = SumTQty + rs.getDouble("r_quan");
                        SumTAmt = SumTAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("D")) {
                        SumDQty = SumDQty + rs.getDouble("r_quan");
                        SumDAmt = SumDAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("P")) {
                        SumPQty = SumPQty + rs.getDouble("r_quan");
                        SumPAmt = SumPAmt + rs.getDouble("r_total");
                    }
                    if (rs.getString("r_etd").equals("W")) {
                        SumWQty = SumWQty + rs.getDouble("r_quan");
                        SumWAmt = SumWAmt + rs.getDouble("r_total");
                    }
                    SumSQty = SumSQty + rs.getDouble("r_quan");
                    SumSAmt = SumSAmt + rs.getDouble("r_total");
            }
            if (SumSQty > 0) {
                    GroupRec = new PluRec();
                    GroupRec.MacNo1 = "";
                    GroupRec.MacNo2 = "";
                    GroupRec.Cashier1 = "";
                    GroupRec.Cashier2 = "";
                    GroupRec.Group1 = "";
                    GroupRec.Group2 = "";
                    GroupRec.Plu1 = "";
                    GroupRec.Plu2 = "";
                    GroupRec.GroupCode = TempGroup;
                    GroupRec.GroupName = PUtility.SeekGroupName(TempGroup);
                    GroupRec.PCode = TempPlu;
                    GroupRec.PName = TempName;

                    GroupRec.E_Qty = GroupRec.E_Qty + SumEQty;
                    GroupRec.E_Amt = GroupRec.E_Amt + SumEAmt;

                    GroupRec.T_Qty = GroupRec.T_Qty + SumTQty;
                    GroupRec.T_Amt = GroupRec.T_Amt + SumTAmt;

                    GroupRec.D_Qty = GroupRec.D_Qty + SumDQty;
                    GroupRec.D_Amt = GroupRec.D_Amt + SumDAmt;

                    GroupRec.P_Qty = GroupRec.P_Qty + SumPQty;
                    GroupRec.P_Amt = GroupRec.P_Amt + SumPAmt;

                    GroupRec.W_Qty = GroupRec.W_Qty + SumWQty;
                    GroupRec.W_Amt = GroupRec.W_Amt + SumWAmt;

                    GroupRec.S_Qty = GroupRec.S_Qty + SumSQty;
                    GroupRec.S_Amt = GroupRec.S_Amt + SumSAmt;
                    if (ArraySize == 0) {
                        GArray[ArraySize] = GroupRec;
                        ArraySize = GArray.length;
                    } else {
                        GArray = PUtility.addPluArray(GArray);
                        ArraySize = GArray.length;
                        GArray[ArraySize - 1] = GroupRec;
                    }
                }

            rs.close();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }
        
        if (Value.printdriver) {
            prn.PrintPluDriver(GArray);
        } else {
            PrintPlu(GArray);
        }

    }

    public void PrintPlu(PluRec[] GArray) {
        Double SumEQty = 0.0;
        Double SumEAmt = 0.0;
        Double SumTQty = 0.0;
        Double SumTAmt = 0.0;
        Double SumDQty = 0.0;
        Double SumDAmt = 0.0;
        Double SumPQty = 0.0;
        Double SumPAmt = 0.0;
        Double SumWQty = 0.0;
        Double SumWAmt = 0.0;
        Double SumSQty = 0.0;
        Double SumSAmt = 0.0;
        int ArraySize = GArray.length;

        prn.InitPrinter();
        prn.print("         รายงานการขายตามรหัสสินค้า");
        prn.print("              (PLU Report)");
        prn.print("          (Automatic XReport)");
        prn.print("หมายเลขเครื่อง :" + Value.MACNO);
        prn.print(" ");
        Date dateP = new Date();
        prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
        prn.print("----------------------------------------");
        prn.print("รายละเอียด");
        prn.print("    .....EAT IN.....   ...TAKE AWAY.....");
        prn.print("    ....DELIVERY....   .....PINTO.......");
        prn.print("    ...WHOLE SALE...   .....TOTAL.......");
        prn.print("----------------------------------------");
        String TempDept = "";
        if (ArraySize > 0) {
            TempDept = "";
        }
        if (GArray[0].S_Qty > 0) {
            for (int i = 0; i < ArraySize; i++) {
                if (!GArray[i].GroupCode.equals(TempDept)) {
                    prn.print(PUtility.DataFullR(GArray[i].GroupCode, 4) + "  " + GArray[i].GroupName);
                    TempDept = GArray[i].GroupCode;
                }

                prn.print(PUtility.DataFullR(GArray[i].PCode + "  " + GArray[i].PName, 38));
                prn.print(PUtility.DataFull(IntFmt.format(GArray[i].E_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].E_Amt), 12) + PUtility.DataFull(IntFmt.format(GArray[i].T_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].T_Amt), 12));
                prn.print(PUtility.DataFull(IntFmt.format(GArray[i].D_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].D_Amt), 12) + PUtility.DataFull(IntFmt.format(GArray[i].P_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].P_Amt), 12));
                prn.print(PUtility.DataFull(IntFmt.format(GArray[i].W_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].W_Amt), 12) + PUtility.DataFull(IntFmt.format(GArray[i].S_Qty), 6) + PUtility.DataFull(DecFmt.format(GArray[i].S_Amt), 12));

                SumEQty = SumEQty + GArray[i].E_Qty;
                SumEAmt = SumEAmt + GArray[i].E_Amt;
                SumTQty = SumTQty + GArray[i].T_Qty;
                SumTAmt = SumTAmt + GArray[i].T_Amt;
                SumDQty = SumDQty + GArray[i].D_Qty;
                SumDAmt = SumDAmt + GArray[i].D_Amt;
                SumPQty = SumPQty + GArray[i].P_Qty;
                SumPAmt = SumPAmt + GArray[i].P_Amt;
                SumWQty = SumWQty + GArray[i].W_Qty;
                SumWAmt = SumWAmt + GArray[i].W_Amt;
                SumSQty = SumSQty + GArray[i].S_Qty;
                SumSAmt = SumSAmt + GArray[i].S_Amt;
            }
        }
        prn.print("----------------------------------------");
        prn.print("***Subtotal***");
        prn.print(PUtility.DataFull(IntFmt.format(SumEQty), 6) + PUtility.DataFull(DecFmt.format(SumEAmt), 12) + PUtility.DataFull(IntFmt.format(SumTQty), 6) + PUtility.DataFull(DecFmt.format(SumTAmt), 12));
        prn.print(PUtility.DataFull(IntFmt.format(SumDQty), 6) + PUtility.DataFull(DecFmt.format(SumDAmt), 12) + PUtility.DataFull(IntFmt.format(SumPQty), 6) + PUtility.DataFull(DecFmt.format(SumPAmt), 12));
        prn.print(PUtility.DataFull(IntFmt.format(SumWQty), 6) + PUtility.DataFull(DecFmt.format(SumWAmt), 12) + PUtility.DataFull(IntFmt.format(SumSQty), 6) + PUtility.DataFull(DecFmt.format(SumSAmt), 12));

        prn.print("----------------------------------------");
        prn.print(" ");
        prn.print(" ");
        prn.print(" ");
        prn.print(POSHW.getHeading1());
        prn.print(POSHW.getHeading2());
        prn.print(POSHW.getHeading3());
        prn.print(POSHW.getHeading4());
        prn.print("REG ID :" + Value.MACNO);
        prn.CutPaper();

    }

    public void ProcessHourly() {
        DailyHourlyOpenTB hl = new DailyHourlyOpenTB(null, true);
        hl.LoadData();
        hl.ProcessProc();
    }

    public void PrintHourly(HourlyRec[] HArray, String MacNo1, String MacNo2) {
        Double SumB = 0.0;
        Double SumC = 0.0;
        Double SumS = 0.0;
        int ArraySize = HArray.length;

        prn.InitPrinter();
        prn.print("         รายงานการขายตามช่วงเวลา");
        prn.print("            (Hourly Report)");
        prn.print("         (Automatic X-Report)");
        prn.print("หมายเลขเครื่อง :" + MacNo1);
        prn.print(" ");
        Date dateP = new Date();
        prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
        prn.print("----------------------------------------");
        prn.print("เวลา    จำนวนบิล   จำนวนลูกค้า    จำนวนเงิน");
        prn.print("----------------------------------------");
        for (int i = 0; i < ArraySize; i++) {

            prn.print(HArray[i].TTime + "  " + PUtility.DataFull(IntFmt.format(HArray[i].TBill), 8) + PUtility.DataFull(IntFmt.format(HArray[i].TCust), 10) + PUtility.DataFull(DecFmt.format(HArray[i].TAmount), 13));

            SumB = SumB + HArray[i].TBill;
            SumC = SumC + HArray[i].TCust;
            SumS = SumS + HArray[i].TAmount;

        }

        prn.print("----------------------------------------");
        prn.print("Total  " + PUtility.DataFull(IntFmt.format(SumB), 8) + PUtility.DataFull(IntFmt.format(SumC), 10) + PUtility.DataFull(DecFmt.format(SumS), 13));

        prn.print("----------------------------------------");
        prn.print(" ");
        prn.print(" ");
        prn.print(" ");
        prn.print(POSHW.getHeading1());
        prn.print(POSHW.getHeading2());
        prn.print(POSHW.getHeading3());
        prn.print(POSHW.getHeading4());
        prn.print("REG ID :" + Value.MACNO);
        prn.CutPaper();

    }

    public void ProcessInv() {
        String MacNo1 = Value.MACNO;
        String MacNo2 = Value.MACNO;
        if (Value.printdriver) {
            InvRep inv = new InvRep(null, true);
            inv.PrintInvDriver(MacNo1, MacNo2);
        } else {
            prn.InitPrinter();
            prn.print("         รายงานการพิมพ์ใบเสร็จรับเงิน");
            prn.print("             (Receipt Report)");
            prn.print("          (Automatic X-Report)");
            prn.print("หมายเลขเครื่อง :" + MacNo1);
            prn.print(" ");
            Date dateP = new Date();
            prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
            prn.print("----------------------------------------");
            prn.print("ใบเสร็จ   เวลาพิมพ์     จำนวนเงิน   ภาษี(Vat)");
            prn.print("----------------------------------------");
            /**
             * * OPEN CONNECTION **
             */
            MySQLConnect mysql = new MySQLConnect();
            mysql.open();
            try {
                Statement stmt = mysql.getConnection().createStatement();
                String SqlQuery = "select * from billno where (b_macno>='" + MacNo1 + "') and (b_macno<='" + MacNo2 + "') order by b_refno";
                ResultSet rs = stmt.executeQuery(SqlQuery);
                while(rs.next()){
                    if (rs.getString("b_void").equals("V")) {
                            prn.print("***Void โดย :" + rs.getString("b_voiduser") + "  " + rs.getString("b_voidtime"));
                        }
                        prn.print(rs.getString("b_refno") + " " + rs.getString("b_ontime") + " " + PUtility.DataFull(DecFmt.format(rs.getDouble("b_nettotal")), 12) + PUtility.DataFull(DecFmt.format(rs.getDouble("b_vat")), 10));
                        if (rs.getDouble("b_cash") != 0) {
                            prn.print("       " + "Cash...............:" + PUtility.DataFull(DecFmt.format(rs.getDouble("b_cash")), 12));
                        }
                        if (rs.getDouble("b_giftvoucher") != 0) {
                            prn.print("       " + "Gift Voucher.......:" + PUtility.DataFull(DecFmt.format(rs.getDouble("b_giftvoucher")), 12));
                        }
                        if (rs.getDouble("b_earnest") != 0) {
                            prn.print("       " + "Earnest............:" + PUtility.DataFull(DecFmt.format(rs.getDouble("b_earnest")), 12));
                        }
                        if (rs.getDouble("b_cramt1") != 0) {
                            prn.print("       " + "***" + PUtility.DataFullR(rs.getString("b_crcode1"), 8) + "........." + PUtility.DataFull(DecFmt.format(rs.getDouble("b_cramt1")), 12));
                        }
                        if (rs.getDouble("b_accramt") != 0) {
                            prn.print("       " + "AR-" + PUtility.DataFullR(rs.getString("b_accrcode"), 8) + "........." + PUtility.DataFull(DecFmt.format(rs.getDouble("b_accramt")), 12));
                            prn.print("       " + PUtility.DataFullR(PUtility.SeekArName(rs.getString("b_accrcode")), 30));
                        }
                }
                rs.close();
                stmt.close();
            } catch (SQLException e) {
                MSG.ERR(e.getMessage());
                AppLogUtil.log(AutoXRep.class, "error", e);
            } finally {
                mysql.close();
            }

            prn.print("----------------------------------------");
            prn.print(" ");
            prn.print(" ");
            prn.print(" ");
            prn.print(POSHW.getHeading1());
            prn.print(POSHW.getHeading2());
            prn.print(POSHW.getHeading3());
            prn.print(POSHW.getHeading4());
            prn.print("REG ID :" + Value.MACNO);
            prn.CutPaper();
        }

    }

    public void ProcessVoid() {
        String MacNo1 = Value.MACNO;
        String MacNo2 = Value.MACNO;
        String CashNo1 = "";
        String CashNo2 = "ZZZZZZ";
        if (Value.printdriver) {
            VoidRep vrd = new VoidRep(null, true);
            vrd.PrintVoidDriver(MacNo1, MacNo2, CashNo1, CashNo2);
        } else {
            prn.InitPrinter();
            prn.print("         รายงานการทำรายการ Void");
            prn.print("              (Void Report)");
            prn.print("          (Automatic X-Report)");
            prn.print("หมายเลขเครื่อง :" + MacNo1);
            prn.print("รหัสพนักงาน    :" + CashNo1 + " ..." + CashNo2);
            prn.print(" ");
            Date dateP = new Date();
            prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
            prn.print("----------------------------------------");
            prn.print("Mac Cashier Table Time  User-Void T_Void");
            prn.print("    Ref-No  PLU-Code       Qty    Amount");
            prn.print("----------------------------------------");
            int SumVoid = 0;
            Double SumAmount = 0.0;
            /**
             * * OPEN CONNECTION **
             */
            MySQLConnect mysql = new MySQLConnect();
            mysql.open();
            try {
                Statement stmt = mysql.getConnection().createStatement();
                String SqlQuery = "select * from t_sale where (macno>='" + MacNo1 + "') and (macno<='" + MacNo2 + "') "
                        + "and (cashier>='" + CashNo1 + "') and (cashier<='" + CashNo2 + "') and (r_void='V') order by macno,cashier,r_time";
                ResultSet rs = stmt.executeQuery(SqlQuery);
                while(rs.next()){
                    prn.print(rs.getString("macno") + " " + PUtility.DataFullR(rs.getString("cashier"), 6) + " " + PUtility.DataFullR(rs.getString("r_table"), 5) + " " + PUtility.DataFullR(rs.getString("r_time"), 6) + "  " + PUtility.DataFullR(rs.getString("r_voiduser"), 10) + " " + PUtility.DataFullR(rs.getString("r_voidtime"), 6));
                        prn.print("     " + PUtility.DataFullR(rs.getString("r_pname"), 35));
                        prn.print("     " + rs.getString("r_refno") + " " + PUtility.DataFull(rs.getString("r_plucode"), 13) + " " + PUtility.DataFull(IntFmt.format(rs.getDouble("r_quan")), 4) + " " + PUtility.DataFull(DecFmt.format(rs.getDouble("r_total")), 8));
                        SumVoid++;
                        SumAmount = SumAmount + rs.getDouble("r_total");
                }
                rs.close();
                stmt.close();
            } catch (SQLException e) {
                MSG.ERR(e.getMessage());
                AppLogUtil.log(AutoXRep.class, "error", e);
            } finally {
                mysql.close();
            }

            prn.print("----------------------------------------");
            prn.print("จำนวน Void :" + PUtility.DataFull(IntFmt.format(SumVoid), 5) + "  จำนวนเงิน :" + PUtility.DataFull(DecFmt.format(SumAmount), 11));
            prn.print("----------------------------------------");
            prn.print(" ");
            prn.print(" ");
            prn.print(" ");
            prn.print(POSHW.getHeading1());
            prn.print(POSHW.getHeading2());
            prn.print(POSHW.getHeading3());
            prn.print(POSHW.getHeading4());
            prn.print("REG ID :" + Value.MACNO);
            prn.CutPaper();
        }

    }

    public void ProcessCredit() {
        String MacNo1 = Value.MACNO;
        String MacNo2 = Value.MACNO;
        String CashNo1 = "";
        String CashNo2 = "ZZZZZZ";

        if (Value.printdriver) {
            CreditRep credit = new CreditRep(null, true);
            credit.PrintCreditDriver(MacNo1, MacNo2, CashNo1, CashNo2);
        } else {
            /**
             * * OPEN CONNECTION **
             */
            MySQLConnect mysql = new MySQLConnect();
            mysql.open();
            try {
                Statement stmt = mysql.getConnection().createStatement();
                String SqlQuery = "delete from tempcredit where terminal='" + Value.MACNO + "'";
                stmt.executeUpdate(SqlQuery);
                stmt.close();
            } catch (SQLException e) {
                MSG.ERR(e.getMessage());
                AppLogUtil.log(AutoXRep.class, "error", e);
            }

            try {
                Statement stmt = mysql.getConnection().createStatement();
                String SqlQuery = "select crcode,DECODE(crid,'snpfood') as crno,crapp,cramt from t_crar where (terminal>='" + MacNo1 + "') "
                        + "and (terminal<='" + MacNo2 + "') and (cashier>='" + CashNo1 + "') and (cashier<='" + CashNo2 + "') and (fat<>'V')";
                ResultSet rs = stmt.executeQuery(SqlQuery);
                while(rs.next()){
                    String TCrCode = rs.getString("crcode");
                        String TCrId = rs.getString("crno");
                        String TCrApp = rs.getString("crapp");
                        Double TCrAmt = rs.getDouble("cramt");
                        InsertTemp(TCrCode, TCrId, TCrApp, TCrAmt);
                }
                rs.close();
                stmt.close();
            } catch (SQLException e) {
                MSG.ERR(e.getMessage());
                AppLogUtil.log(AutoXRep.class, "error", e);
            }
            
            prn.InitPrinter();
            prn.print("         รายงานการรับชำระด้วยบัตรเครดิต");
            prn.print("               (Credit Report)");
            prn.print("            (Automatic X-Report)");
            prn.print("หมายเลขเครื่อง :" + MacNo1);
            prn.print("รหัสพนักงาน    :" + CashNo1 + " ..." + CashNo2);
            prn.print(" ");
            Date dateP = new Date();
            prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
            prn.print("----------------------------------------");
            prn.print("ประเภทบัตร    ชื่อบัตรเครดิต");
            prn.print("ลำดับ  หมายเลขบัตร     รหัสอนุมัติ    จำนวนเงิน");
            prn.print("----------------------------------------");
            int SumVoid = 0;
            String TempCr = "";
            int SumCard = 0;
            Double SumCardAmt = 0.0;
            int SumTotal = 0;
            Double SumTotalAmt = 0.0;
            try {
                Statement stmt = mysql.getConnection().createStatement();
                String SqlQuery = "select * from tempcredit where (terminal='" + Value.MACNO + "') order by crcode";
                ResultSet rs = stmt.executeQuery(SqlQuery);
                while(rs.next()){
                    prn.print(rs.getString("crcode") + "   " + PUtility.SeekCreditName(rs.getString("crcode")));
                    TempCr = rs.getString("crcode");
                    
                    if (!rs.getString("crcode").equals(TempCr)) {
                            prn.print("       Total Slip " + PUtility.DataFull(IntFmt.format(SumCard), 6) + "    " + PUtility.DataFull(DecFmt.format(SumCardAmt), 11));
                            prn.print("                 " + "-----------------------");
                            SumCard = 0;
                            SumCardAmt = 0.0;
                            prn.print(rs.getString("crcode") + "   " + PUtility.SeekCreditName(rs.getString("crcode")));
                            TempCr = rs.getString("crcode");
                        }
                        SumCard++;
                        SumCardAmt = SumCardAmt + rs.getDouble("cramt");
                        SumTotal++;
                        SumTotalAmt = SumTotalAmt + rs.getDouble("cramt");
                        String TempCrId = PUtility.Addzero(rs.getString("crid"), 16);
                        prn.print(PUtility.DataFull(IntFmt.format(SumCard), 5) + "  " + "XXXXXXXXXXXX" + TempCrId.substring(12, 16) + " " + PUtility.DataFullR(rs.getString("crapp"), 6) + PUtility.DataFull(DecFmt.format(rs.getDouble("cramt")), 9));
                }
                rs.close();
                stmt.close();
            } catch (SQLException e) {
                MSG.ERR(e.getMessage());
                AppLogUtil.log(AutoXRep.class, "error", e);
            } finally {
                mysql.close();
            }
            
            if (SumCard > 0) {
                prn.print("       Total Slip " + PUtility.DataFull(IntFmt.format(SumCard), 6) + "    " + PUtility.DataFull(DecFmt.format(SumCardAmt), 11));
                prn.print("                 " + "-----------------------");
            }
            prn.print("----------------------------------------");
            prn.print("Sum-Total Slip  " + PUtility.DataFull(IntFmt.format(SumTotal), 6) + "    " + PUtility.DataFull(DecFmt.format(SumTotalAmt), 13));
            prn.print("----------------------------------------");
            prn.print(" ");
            prn.print(" ");
            prn.print(" ");
            prn.print(POSHW.getHeading1());
            prn.print(POSHW.getHeading2());
            prn.print(POSHW.getHeading3());
            prn.print(POSHW.getHeading4());
            prn.print("REG ID :" + Value.MACNO);
            prn.CutPaper();

        }

    }

    public void InsertTemp(String TCrCode, String TCrId, String TCrApp, Double TCrAmt) {
        /**
         * * OPEN CONNECTION **
         */
        MySQLConnect mysql = new MySQLConnect();
        mysql.open();
        try {
            Statement stmt = mysql.getConnection().createStatement();
            String SqlQuery = "insert into tempcredit (terminal,crcode,crid,crapp,cramt) "
                    + "values (?,?,?,?,?)";
            PreparedStatement prm = mysql.getConnection().prepareStatement(SqlQuery);
            prm.setString(1, Value.MACNO);
            prm.setString(2, TCrCode);
            prm.setString(3, TCrId);
            prm.setString(4, TCrApp);
            prm.setDouble(5, TCrAmt);
            prm.executeUpdate();
            stmt.close();
        } catch (SQLException e) {
            MSG.ERR(e.getMessage());
            AppLogUtil.log(AutoXRep.class, "error", e);
        } finally {
            mysql.close();
        }
    }

    public void ProcessGiftVoucher() {
        String MacNo1 = Value.MACNO;
        String MacNo2 = Value.MACNO;
        String CashNo1 = "";
        String CashNo2 = "ZZZZZZ";
        if (Value.printdriver) {
            GiftVoucherRep gift = new GiftVoucherRep(null, true);
            gift.PrintVoucherRepDriver(MacNo1, MacNo2, CashNo1, CashNo2);
        } else {
            prn.InitPrinter();
            prn.print("       รายงานการรับชำระด้วยบัตรของขวัญ");
            prn.print("          (Gift Voucher Report)");
            prn.print("          (Automatic X-Report)");
            prn.print("หมายเลขเครื่อง :" + MacNo1);
            prn.print("รหัสพนักงาน    :" + CashNo1 + " ..." + CashNo2);
            prn.print(" ");
            Date dateP = new Date();
            prn.print(DatefmtThai.format(dateP) + " " + "Cashier:" + PublicVar._User + " Mac:" + Value.MACNO);
            prn.print("----------------------------------------");
            prn.print("Code                  NO          Amount");
            prn.print("----------------------------------------");
            int Sumtotal = 0;
            Double SumtotalAmount = 0.0;
            /**
             * * OPEN CONNECTION **
             */
            MySQLConnect mysql = new MySQLConnect();
            mysql.open();
            try {
                Statement stmt = mysql.getConnection().createStatement();
                String SqlQuery = "select *from t_gift where (macno>='" + MacNo1 + "') and (macno<='" + MacNo2 + "') and (cashier>='" + CashNo1 + "') "
                        + "and (cashier<='" + CashNo2 + "') and (fat='V') order by giftbarcode";
                ResultSet rs = stmt.executeQuery(SqlQuery);
                while(rs.next()){
                    prn.print(PUtility.DataFullR(rs.getString("giftbarcode"), 27) + "  " + PUtility.DataFull(DecFmt.format(rs.getDouble("giftamt")), 9));
                        Sumtotal++;
                        SumtotalAmount = SumtotalAmount + rs.getDouble("giftamt");
                }
                rs.close();
                stmt.close();
            } catch (SQLException e) {
                MSG.ERR(e.getMessage());
                AppLogUtil.log(AutoXRep.class, "error", e);
            } finally {
                mysql.close();
            }

            prn.print("----------------------------------------");
            prn.print("Sum-Total Gift " + PUtility.DataFull(IntFmt.format(Sumtotal), 6) + "     " + PUtility.DataFull(DecFmt.format(SumtotalAmount), 13));
            prn.print("----------------------------------------");
            prn.print(" ");
            prn.print(" ");
            prn.print(" ");
            prn.print(POSHW.getHeading1());
            prn.print(POSHW.getHeading2());
            prn.print(POSHW.getHeading3());
            prn.print(POSHW.getHeading4());
            prn.print("REG ID :" + Value.MACNO);
            prn.CutPaper();
        }

    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel TMacNo;
    private javax.swing.JButton bntExit;
    private javax.swing.JButton bntOK;
    private javax.swing.JButton bntSelectAll;
    private javax.swing.JCheckBox chkCashier;
    private javax.swing.JCheckBox chkCredit;
    private javax.swing.JCheckBox chkGiftVoucher;
    private javax.swing.JCheckBox chkGroup;
    private javax.swing.JCheckBox chkHourly;
    private javax.swing.JCheckBox chkPlu;
    private javax.swing.JCheckBox chkReceipt;
    private javax.swing.JCheckBox chkTerminal;
    private javax.swing.JCheckBox chkVoid;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    // End of variables declaration//GEN-END:variables
}
